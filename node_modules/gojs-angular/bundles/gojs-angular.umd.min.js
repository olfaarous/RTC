!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("gojs")):"function"==typeof define&&define.amd?define("gojs-angular",["exports","@angular/core","gojs"],t):t((e=e||self)["gojs-angular"]={},e.ng.core,e.gojs)}(this,(function(e,t,a){"use strict";var i=function(){function e(e,a,i){this._differs=e,this._kvdiffers=a,this.zone=i,this.linkDataArray=null,this.modelData=null,this.modelChangedListener=null,this.modelChange=new t.EventEmitter,this.diagram=null,this._ndaDiffer=this._differs.find([]).create(null),this._ldaDiffer=this._differs.find([]).create(null)}return e.prototype.ngOnInit=function(){this.modelData&&(this._mdDiffer=this._kvdiffers.find(this.modelData).create())},e.prototype.ngAfterViewInit=function(){var e=this;this.diagram=this.initDiagram(),this.diagram.addEventListener=function(t,i,n,r){var o=a.Diagram.prototype.addEventListener;"mousemove"===i?e.zone.runOutsideAngular((function(){return o.call(e,t,i,n,r)})):e.zone.run((function(){o.call(e,t,i,n,r)}))};var t=this.diagramDiv.nativeElement;null!==t&&(this.diagram.div=t,this.diagram.delayInitialization((function(){e.diagram.model.commit((function(t){t.mergeNodeDataArray(t.cloneDeep(e.nodeDataArray)),e.linkDataArray&&t instanceof a.GraphLinksModel&&t.mergeLinkDataArray(t.cloneDeep(e.linkDataArray)),e.modelData&&t.assignAllDataProperties(t.modelData,e.modelData)}),null)})),this.modelChangedListener=function(t){t.isTransactionFinished&&e.zone.run((function(){var a=t.model.toIncrementalData(t);e.modelChange.emit(a)}))},this.diagram.addModelChangedListener(this.modelChangedListener))},e.prototype.ngDoCheck=function(){var e=this._ndaDiffer.diff(this.nodeDataArray),t=this._ldaDiffer.diff(this.linkDataArray),a=null;this._mdDiffer&&(a=this._mdDiffer.diff(this.modelData)),(e||t||a)&&this.updateFromAppData()},e.prototype.updateFromAppData=function(){if(this.diagram){var e=this.diagram.model;null!==this.modelChangedListener&&e.removeChangedListener(this.modelChangedListener),e.startTransaction("update data"),e.mergeNodeDataArray(e.cloneDeep(this.nodeDataArray)),this.linkDataArray&&e instanceof a.GraphLinksModel&&e.mergeLinkDataArray(e.cloneDeep(this.linkDataArray)),this.modelData&&e.assignAllDataProperties(e.modelData,this.modelData),e.commitTransaction("update data"),null!==this.modelChangedListener&&e.addChangedListener(this.modelChangedListener)}},e.decorators=[{type:t.Component,args:[{selector:"gojs-diagram",template:"<div #ngDiagram [className]=divClassName></div>"}]}],e.ctorParameters=function(){return[{type:t.IterableDiffers},{type:t.KeyValueDiffers},{type:t.NgZone}]},e.propDecorators={initDiagram:[{type:t.Input}],nodeDataArray:[{type:t.Input}],linkDataArray:[{type:t.Input}],modelData:[{type:t.Input}],divClassName:[{type:t.Input}],modelChangedListener:[{type:t.Input}],modelChange:[{type:t.Output}],diagramDiv:[{type:t.ViewChild,args:["ngDiagram",{static:!0}]}]},e}();var n=function(){function e(e,a,i){this._differs=e,this._kvdiffers=a,this.zone=i,this.linkDataArray=null,this.modelData=null,this.modelChangedListener=null,this.modelChange=new t.EventEmitter,this.palette=null,this._ndaDiffer=this._differs.find([]).create(null),this._ldaDiffer=this._differs.find([]).create(null)}return e.prototype.ngOnInit=function(){this.modelData&&(this._mdDiffer=this._kvdiffers.find(this.modelData).create())},e.prototype.ngAfterViewInit=function(){var e=this;if(this.paletteDiv){this.palette=this.initPalette(),this.palette.addEventListener=function(t,i,n,r){var o=a.Diagram.prototype.addEventListener;"mousemove"===i?e.zone.runOutsideAngular((function(){return o.call(e,t,i,n,r)})):e.zone.run((function(){o.call(e,t,i,n,r)}))};var t=this.paletteDiv.nativeElement;this.palette.div=t,this.palette.delayInitialization((function(){e.palette.model.commit((function(t){t.mergeNodeDataArray(t.cloneDeep(e.nodeDataArray)),e.linkDataArray&&t instanceof a.GraphLinksModel&&t.mergeLinkDataArray(t.cloneDeep(e.linkDataArray)),e.modelData&&t.assignAllDataProperties(t.modelData,e.modelData)}),null)})),this.modelChangedListener=function(t){t.isTransactionFinished&&e.zone.run((function(){var a=t.model.toIncrementalData(t);e.modelChange.emit(a)}))},this.palette.addModelChangedListener(this.modelChangedListener)}},e.prototype.ngDoCheck=function(){var e=this._ndaDiffer.diff(this.nodeDataArray),t=this._ldaDiffer.diff(this.linkDataArray),a=null;this._mdDiffer&&(a=this._mdDiffer.diff(this.modelData)),(e||t||a)&&this.updateFromAppData()},e.prototype.updateFromAppData=function(){if(this.palette){var e=this.palette.model;e.startTransaction("update data"),e.mergeNodeDataArray(e.cloneDeep(this.nodeDataArray)),this.linkDataArray&&e instanceof a.GraphLinksModel&&e.mergeLinkDataArray(e.cloneDeep(this.linkDataArray)),this.modelData&&e.assignAllDataProperties(e.modelData,this.modelData),e.commitTransaction("update data")}},e.decorators=[{type:t.Component,args:[{selector:"gojs-palette",template:"<div #ngPalette [className]=divClassName></div>"}]}],e.ctorParameters=function(){return[{type:t.IterableDiffers},{type:t.KeyValueDiffers},{type:t.NgZone}]},e.propDecorators={initPalette:[{type:t.Input}],nodeDataArray:[{type:t.Input}],linkDataArray:[{type:t.Input}],modelData:[{type:t.Input}],divClassName:[{type:t.Input}],modelChangedListener:[{type:t.Input}],modelChange:[{type:t.Output}],paletteDiv:[{type:t.ViewChild,args:["ngPalette",{static:!0}]}]},e}();var r=function(){function e(e){this.zone=e,this.observedDiagram=null,this.overview=null}return e.prototype.ngAfterViewInit=function(){var e=this;this.overviewDiv&&(this.initOverview?this.overview=this.initOverview():(this.overview=new a.Overview,this.overview.contentAlignment=a.Spot.Center),this.overview.addEventListener=function(t,i,n,r){var o=a.Diagram.prototype.addEventListener;"mousemove"===i?e.zone.runOutsideAngular((function(){return o.call(e,t,i,n,r)})):e.zone.run((function(){o.call(e,t,i,n,r)}))},this.overview.div=this.overviewDiv.nativeElement)},e.prototype.ngOnChanges=function(e){this.overview&&e&&e.observedDiagram&&e.observedDiagram.currentValue!==e.observedDiagram.previousValue&&(this.overview.observed=e.observedDiagram.currentValue)},e.decorators=[{type:t.Component,args:[{selector:"gojs-overview",template:"<div #ngOverview [className]=divClassName></div>"}]}],e.ctorParameters=function(){return[{type:t.NgZone}]},e.propDecorators={initOverview:[{type:t.Input}],divClassName:[{type:t.Input}],observedDiagram:[{type:t.Input}],overviewDiv:[{type:t.ViewChild,args:["ngOverview",{static:!0}]}]},e}();var o=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:[i,r,n],imports:[],exports:[i,r,n]}]}],e}(),s=function(){function e(){}return e.syncNodeData=function(e,t){if(!e)return t;if(!e.modifiedNodeData&&!e.insertedNodeKeys&&!e.removedNodeKeys)return t;var i=new a.Map;return e.modifiedNodeData&&e.modifiedNodeData.forEach((function(e){i.set(e.key,e);for(var a=e.key,n=0;n<t.length;n++){t[n].key===a&&(t[n]=e)}})),e.insertedNodeKeys&&e.insertedNodeKeys.forEach((function(e){var a=i.get(e);a&&t.push(a)})),e.removedNodeKeys&&(t=t.filter((function(t){return!e.removedNodeKeys.includes(t.key)}))),t},e.syncLinkData=function(e,t){if(!e)return t;if(!e.modifiedLinkData&&!e.insertedLinkKeys&&!e.removedLinkKeys)return t;var i=new a.Map;return e.modifiedLinkData&&e.modifiedLinkData.forEach((function(e){i.set(e.key,e);for(var a=e.key,n=0;n<t.length;n++){t[n].key===a&&(t[n]=e)}})),e.insertedLinkKeys&&e.insertedLinkKeys.forEach((function(e){var a=i.get(e);a&&t.push(a)})),e.removedLinkKeys&&(t=t.filter((function(t){return!e.removedLinkKeys.includes(t.key)}))),t},e.syncModelData=function(e,t){return e&&e.modelData?e.modelData?e.modelData:void 0:t},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ɵprov=t["ɵɵdefineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e}();e.DataSyncService=s,e.DiagramComponent=i,e.GojsAngularModule=o,e.OverviewComponent=r,e.PaletteComponent=n,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=gojs-angular.umd.min.js.map